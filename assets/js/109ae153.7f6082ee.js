"use strict";(self.webpackChunk_hades_ts_docs=self.webpackChunk_hades_ts_docs||[]).push([[2520],{4610:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var i=t(538);const o={},s=i.createContext(o);function r(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:n},e.children)}},9799:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"solid-code","title":"Writing SOLID Code","description":"Or: Saying what but not how.","source":"@site/docs/guides/solid-code.md","sourceDirName":".","slug":"/solid-code","permalink":"/docs/guides/solid-code","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"guides","previous":{"title":"Generating a Bot","permalink":"/docs/guides/bot-generator"},"next":{"title":"Dependency Injection","permalink":"/docs/guides/di"}}');var o=t(7282),s=t(4610);const r={},a="Writing SOLID Code",l={},d=[{value:"Why Use Dependency Injection?",id:"why-use-dependency-injection",level:2},{value:"Encapsulation and Naive Refactoring",id:"encapsulation-and-naive-refactoring",level:2},{value:"The Three Spirits of Encapsulation",id:"the-three-spirits-of-encapsulation",level:2},{value:"Strategy and Implementation",id:"strategy-and-implementation",level:2},{value:"Understanding Strategy",id:"understanding-strategy",level:3},{value:"Understanding Implementation",id:"understanding-implementation",level:3},{value:"Expressiveness",id:"expressiveness",level:3},{value:"Writing Expressive Code",id:"writing-expressive-code",level:2},{value:"Distillation",id:"distillation",level:3},{value:"Delegation",id:"delegation",level:3},{value:"Squinting",id:"squinting",level:3},{value:"Dependencies",id:"dependencies",level:2},{value:"Where Do Dependencies Come From?",id:"where-do-dependencies-come-from",level:3},{value:"Construction",id:"construction",level:3},{value:"Service Location",id:"service-location",level:3},{value:"Dependency Injection",id:"dependency-injection",level:3},{value:"Why Dependency Injection is Best",id:"why-dependency-injection-is-best",level:2},{value:"Inversion of Control",id:"inversion-of-control",level:3},{value:"SOLID Principles",id:"solid-principles",level:3},{value:"Clarity of Mind",id:"clarity-of-mind",level:2}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"writing-solid-code",children:"Writing SOLID Code"})}),"\n",(0,o.jsxs)(n.p,{children:["Or: ",(0,o.jsx)(n.em,{children:"Saying what but not how"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"Obviously, a complete description of what makes code good is not going to fit into the following sections."}),"\n",(0,o.jsx)(n.p,{children:"Instead, we'll explore one key idea that might contribute to code being good: Dependency Injection"}),"\n",(0,o.jsx)(n.h2,{id:"why-use-dependency-injection",children:"Why Use Dependency Injection?"}),"\n",(0,o.jsx)(n.p,{children:"You may or may not already be familiar with dependency injection as a design pattern."}),"\n",(0,o.jsx)(n.p,{children:"If not, this document will try to build up an intuition for its value starting from the ground up."}),"\n",(0,o.jsx)(n.p,{children:"Even if you are familiar with dependency injection, you may find the following an interesting read."}),"\n",(0,o.jsx)(n.h2,{id:"encapsulation-and-naive-refactoring",children:"Encapsulation and Naive Refactoring"}),"\n",(0,o.jsx)(n.p,{children:"What does encapsulation mean?"}),"\n",(0,o.jsx)(n.p,{children:"A workable definition could be:"}),"\n",(0,o.jsx)(n.p,{children:"To put what is on the outside on the inside."}),"\n",(0,o.jsx)(n.p,{children:"What does refactoring mean?"}),"\n",(0,o.jsx)(n.p,{children:"A workable definition could be:"}),"\n",(0,o.jsx)(n.p,{children:"To restructure software to improve it, usually without changing its functionality."}),"\n",(0,o.jsx)(n.p,{children:'Most developers are familiar with the kind of "naive refactoring" we often do where we try to break up a function or class into smaller parts.'}),"\n",(0,o.jsx)(n.p,{children:"It's this kind of refactoring we'll explore. To think a bit deeper about why we do this kind of refactoring so that we can do it wittingly."}),"\n",(0,o.jsx)(n.h2,{id:"the-three-spirits-of-encapsulation",children:"The Three Spirits of Encapsulation"}),"\n",(0,o.jsx)(n.p,{children:"There are two primary ways to do encapsulation in most modern languages:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Functions"}),"\n",(0,o.jsx)(n.li,{children:"Classes"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"We wont get into their differences right now."}),"\n",(0,o.jsx)(n.p,{children:"Currently we're interested in an important way in which they are similar."}),"\n",(0,o.jsx)(n.p,{children:"They both let you put stuff that's outside, on the inside."}),"\n",(0,o.jsx)(n.p,{children:"In both cases, each has three primary aspects, or spirits:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Its overall responsibility or purpose"}),"\n",(0,o.jsx)(n.li,{children:"A strategy it uses to fulfill that purpose"}),"\n",(0,o.jsx)(n.li,{children:"The specific implementation of that strategy"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"That a function or class' has purpose is straight-forward enough."}),"\n",(0,o.jsx)(n.p,{children:"But that it has both a strategy and an implementation of that strategy, as separate things, that's more interesting."}),"\n",(0,o.jsx)(n.h2,{id:"strategy-and-implementation",children:"Strategy and Implementation"}),"\n",(0,o.jsx)(n.p,{children:"What makes a strategy and the implementation of that strategy different things?"}),"\n",(0,o.jsx)(n.p,{children:"Here's an easy way to think about it:"}),"\n",(0,o.jsx)(n.p,{children:"For any strategy, there are multiple implementations of that strategy"}),"\n",(0,o.jsx)(n.p,{children:"Hence they're not necessarily the same thing."}),"\n",(0,o.jsx)(n.p,{children:"For trivial cases, they can be -- but it's not the trivial cases that cause us trouble."}),"\n",(0,o.jsx)(n.h3,{id:"understanding-strategy",children:"Understanding Strategy"}),"\n",(0,o.jsx)(n.p,{children:"Consider this:"}),"\n",(0,o.jsx)(n.p,{children:"If you have the wrong strategy, no implementation of it is helpful."}),"\n",(0,o.jsx)(n.p,{children:"You must first have a strategy which accomplishes the right goal."}),"\n",(0,o.jsx)(n.p,{children:"If we have the wrong strategy, it doesn't matter how correct or incorrect the implementation of that strategy is."}),"\n",(0,o.jsx)(n.h3,{id:"understanding-implementation",children:"Understanding Implementation"}),"\n",(0,o.jsx)(n.p,{children:"Consider this:"}),"\n",(0,o.jsx)(n.p,{children:"To understand which strategy is employed by some code, you must first understand its implementation."}),"\n",(0,o.jsx)(n.p,{children:"Only by first working through the existing implementation of a strategy can we even get at which strategy is being used."}),"\n",(0,o.jsx)(n.p,{children:"Understanding the implementation is a barrier to understanding the strategy which is a barrier to understanding if the implementation is correct."}),"\n",(0,o.jsx)(n.p,{children:"There's gotta be a better way!"}),"\n",(0,o.jsx)(n.h3,{id:"expressiveness",children:"Expressiveness"}),"\n",(0,o.jsx)(n.p,{children:"Expressiveness is one of those terms that gets thrown around a lot and everyone has their own definition."}),"\n",(0,o.jsx)(n.p,{children:"But we can now consider a very particular form of expressiveness:"}),"\n",(0,o.jsx)(n.p,{children:"How readily some code says what its strategy is."}),"\n",(0,o.jsx)(n.h2,{id:"writing-expressive-code",children:"Writing Expressive Code"}),"\n",(0,o.jsx)(n.p,{children:"How can we address the contention between strategy and implementation?"}),"\n",(0,o.jsx)(n.p,{children:"How can we write code that says what its strategy is, without the implementation getting in our way?"}),"\n",(0,o.jsx)(n.h3,{id:"distillation",children:"Distillation"}),"\n",(0,o.jsx)(n.p,{children:'If the strategy is "what is done" and implementation is "how it is done",'}),"\n",(0,o.jsx)(n.p,{children:"Distillation is then:"}),"\n",(0,o.jsx)(n.p,{children:"Reducing the amount of detail regarding the how of what is done."}),"\n",(0,o.jsx)(n.p,{children:"This is where encapsulation comes back into the picture."}),"\n",(0,o.jsx)(n.h3,{id:"delegation",children:"Delegation"}),"\n",(0,o.jsx)(n.p,{children:"We can achieve the distillation we're after through delegation."}),"\n",(0,o.jsx)(n.p,{children:"By throwing those implementation details into some secondary encapsulation we can then delegate to it."}),"\n",(0,o.jsx)(n.p,{children:"By delegating to the encapsulation we replace the implementation details with a call to that delegate."}),"\n",(0,o.jsxs)(n.p,{children:["Assuming we have good naming convention and style, what is left over is an artifact saying ",(0,o.jsx)(n.em,{children:"what"})," we're doing but ",(0,o.jsx)(n.em,{children:"not how"}),"."]}),"\n",(0,o.jsx)(n.p,{children:'The "how" has been hidden inside the delegate encapsulation.'}),"\n",(0,o.jsx)(n.h3,{id:"squinting",children:"Squinting"}),"\n",(0,o.jsx)(n.p,{children:"How do we know which bits of implementation to group together and delegate out into an encapsulation?"}),"\n",(0,o.jsx)(n.p,{children:"Well, in general, we want to capture the very highest-level description of the local strategy."}),"\n",(0,o.jsx)(n.p,{children:"Obviously, you can take this too far."}),"\n",(0,o.jsx)(n.p,{children:"If you're trying to tell someone how to draw a house, giving them the single step of \"1. draw the house\" isn't very helpful. It's too coarse of a description."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"function() drawHouse() {\n    drawHouse()\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"At the opposite end of the spectrum we have the implementation itself, all the atomic steps needed to carry out the strategy."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'function drawHouse() {\n  pen.goto(0, 0);\n  pen.color("blue");\n  for (let i = 0; i < 2; i++) {\n    pen.forward(100);\n    pen.left(90);\n    pen.forward(100);\n    pen.left(90);\n  }\n  pen.goto(0, 100);\n  pen.color("green");\n  for (let i = 0; i < 3; i++) {\n    pen.forward(100);\n    pen.left(120);\n  }\n  pen.goto(40, 0);\n  pen.color("brown");\n  for (let i = 0; i < 2; i++) {\n    pen.forward(20);\n    pen.left(90);\n    pen.forward(50);\n    pen.left(90);\n  }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"What we want is something that approaches the former without reaching it. We want to express the minimal number of steps but enough to actually differentiate this strategy from the alternatives."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'function drawTriangle(x: number, y: number, length: number, color: string) {\n  pen.goto(x, y);\n  pen.color(color);\n  for (let i = 0; i < 3; i++) {\n    pen.forward(length);\n    pen.left(120);\n  }\n}\n\nfunction drawRectangle(x: number, y: number, length: number, color: string) {\n  pen.goto(x, y);\n  pen.color(color);\n  for (let i = 0; i < 2; i++) {\n    pen.forward(width);\n    pen.left(90);\n    pen.forward(height);\n    pen.left(90);\n  }\n}\n\nfunction drawWalls() {\n  drawRectangle(0, 0, 100, 100, "blue");\n}\n\nfunction drawRoof() {\n  drawTriangle(0, 100, 100, "green");\n}\n\nfunction drawDoor() {\n  drawRectangle(40, 0, 20, 50, "brown");\n}\n\nfunction drawHouse() {\n  drawWalls();\n  drawRoof();\n  drawDoor();\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Unfortunately there is no generalized method for deriving what level of description best conveys the nature of a given strategy."}),"\n",(0,o.jsx)(n.p,{children:"You'll just have to squint."}),"\n",(0,o.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,o.jsx)(n.p,{children:"With delegation as our approach of choice for distillation we introduce a curious problem."}),"\n",(0,o.jsx)(n.p,{children:"We introduce a dependency relationship from the distilled to the delegate."}),"\n",(0,o.jsx)(n.h3,{id:"where-do-dependencies-come-from",children:"Where Do Dependencies Come From?"}),"\n",(0,o.jsx)(n.p,{children:"There are three primary ways we can get at dependencies:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Construction"}),"\n",(0,o.jsx)(n.li,{children:"Service Location"}),"\n",(0,o.jsx)(n.li,{children:"Dependency Injection"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"One of these is not like the other two. Can you guess which?"}),"\n",(0,o.jsx)(n.h3,{id:"construction",children:"Construction"}),"\n",(0,o.jsx)(n.p,{children:"With construction, we instantiate the dependency directly ourselves. Not only do we take on providing our own dependency, but all of its constructor arguments too."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'class Foo {\n  bar: Bar = new Bar("x", "y", "z");\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"service-location",children:"Service Location"}),"\n",(0,o.jsx)(n.p,{children:"Service location is any mechanism for reaching out to a parent scope in order to reference the dependency. This might be in the form of an import or a module-level local."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'const bar = new Bar("x", "y", "z"); // or import { bar } from "./some-module";\n\nclass Foo {\n  bar: Bar = bar;\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"dependency-injection",children:"Dependency Injection"}),"\n",(0,o.jsx)(n.p,{children:'"Dependency Injection" means it is up to someone else to provide our dependencies to us. Usually this is in the form of function or constructor arguments.'}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"class Foo {\n  bar: Bar;\n  constructor(bar: Bar) {\n    this.bar = bar;\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"why-dependency-injection-is-best",children:"Why Dependency Injection is Best"}),"\n",(0,o.jsx)(n.p,{children:"Dependency injection is the only way to obtain dependencies that embodies the principle of Inversion of Control."}),"\n",(0,o.jsx)(n.h3,{id:"inversion-of-control",children:"Inversion of Control"}),"\n",(0,o.jsx)(n.p,{children:'"Inversion of Control" is a general idea wherein we relinquish control over objects, data, or other portions of our program to... well someone else!'}),"\n",(0,o.jsx)(n.p,{children:"In the case of dependency injection, we are relinquishing control over where our dependencies come from."}),"\n",(0,o.jsx)(n.p,{children:'Someone else must "inject" those dependencies into us, usually via function or constructor parameter.'}),"\n",(0,o.jsx)(n.h3,{id:"solid-principles",children:"SOLID Principles"}),"\n",(0,o.jsx)(n.p,{children:"Dependency injection helps us achieve each of the other SOLID principles."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Single Responsibility Principle"})}),"\n",(0,o.jsx)(n.p,{children:"By delegating implementation details out to subordinate encapsulations we leave only orchestrating those dependencies as the sole responsibility of most components."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Open / Close Principle"})}),"\n",(0,o.jsx)(n.p,{children:"By changing which dependencies are injected, we can change the behavior of the consumer without modifying it."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Liskov Substitution Principle"})}),"\n",(0,o.jsx)(n.p,{children:"By specifying our dependencies as interfaces, we don't care which specific dependency we get, we just need one we can work with."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Interface Segregation Principle"})}),"\n",(0,o.jsx)(n.p,{children:"Taking in narrowly typed dependencies that represent just the functionality we need avoids utilizing resources or behavior our function or class doesn't actually need, or shouldn't use."}),"\n",(0,o.jsx)(n.h2,{id:"clarity-of-mind",children:"Clarity of Mind"}),"\n",(0,o.jsx)(n.p,{children:"The biggest advantage to dependency injection is focus and clarity of mind we are able to enjoy while working on any individual component."}),"\n",(0,o.jsx)(n.p,{children:"If we understand the responsibility or purpose of the component we're working on, we can start to formulate a high-level strategy it might take."}),"\n",(0,o.jsx)(n.p,{children:"As you start to write the component, we no longer need to start off by typing out all the implementation details."}),"\n",(0,o.jsx)(n.p,{children:"Instead, we can simply declare dependencies, even if they don't exist yet, that would be the most helpful delegates for saying what our component's strategy is."}),"\n",(0,o.jsx)(n.p,{children:"All we need to worry about is orchestrating those dependencies to carry out that strategy in the most distilled and expressive way possible."}),"\n",(0,o.jsx)(n.p,{children:"Once we are satisfied, we can move on to implementing the dependencies and hashing out the implementation details."}),"\n",(0,o.jsx)(n.p,{children:"Of course, we can apply this exact same thinking to the implementation of those dependencies."}),"\n",(0,o.jsx)(n.p,{children:"We can keep delegating until there's nothing left to delegate. Until further delegation would result in simply saying \"1. draw the owl\". At that point it's time to stop delegation an actually implement the narrow concern or responsibility at hand."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);